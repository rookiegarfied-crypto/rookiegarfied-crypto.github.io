<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>纯前端生成 Word 文档</title>
<style>
  body {
    margin: 0;
    font-family: Arial;
  }
  .header {
    background-image: url(https://picsum.photos/1200/300); /* 你自己的背景图 */
    background-size: cover;
    background-position: center;
    height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
  }
  .buttons {
    margin: 20px;
  }
  button {
    padding: 10px 20px;
    margin-right: 10px;
    font-size: 16px;
  }
  .page {
    display: none;
    padding: 20px;
  }
  .page.active {
    display: block;
  }
  table {
    border-collapse: collapse;
  }
  table, th, td {
    border: 1px solid black;
  }
  th, td {
    padding: 8px;
  }
</style>
<!-- 引入 docx 库（浏览器版本） -->
<script src="https://unpkg.com/pizzip@3.1.1/js/index.js"></script>
</head>
<body>

<div class="header">
  我的应用
</div>

<!-- 首页 -->
<div id="homePage" class="page active">
  <div class="buttons">
    <button onclick="goToPage('tablePage')">表格页面</button>
    <button>按钮2（暂定）</button>
    <button>按钮3（暂定）</button>
  </div>
</div>

<!-- 表格页面 -->
<div id="tablePage" class="page">
  <h2>请选择需要生成文档的内容</h2>
  <form id="tableForm">
    <table>
      <tr>
        <th>选择</th>
        <th>内容</th>
      </tr>
      <tr>
        <td><input type="checkbox" name="rows" value="内容A"></td>
        <td>内容A</td>
      </tr>
      <tr>
        <td><input type="checkbox" name="rows" value="内容B"></td>
        <td>内容B</td>
      </tr>
      <tr>
        <td><input type="checkbox" name="rows" value="内容C"></td>
        <td>内容C</td>
      </tr>
    </table>
    <br>
    <button type="button" onclick="submitSelection()">下一步</button>
    <button type="button" onclick="goToPage('homePage')">返回首页</button>
  </form>
</div>

<!-- 下载页面 -->
<div id="downloadPage" class="page">
  <h2>文档已生成</h2>
  <div id="downloadLink"></div>
  <button onclick="goToPage('homePage')">返回首页</button>
</div>

<script>
function goToPage(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
}

function submitSelection() {
    const formData = new FormData(document.getElementById('tableForm'));
    const selected = formData.getAll('rows');
    if (selected.length === 0) {
        alert('请至少选择一项');
        return;
    }

    // 使用 docx 库生成 Word 文档
    const { Document, Packer, Paragraph } = window.docx;

    const doc = new Document({
        sections: [{
            children: selected.map(text => new Paragraph(text)),
        }],
    });

    Packer.toBlob(doc).then(blob => {
        const fileName = `doc_${Date.now()}.docx`;
        const url = URL.createObjectURL(blob);
        document.getElementById('downloadLink').innerHTML =
            `<a href="${url}" download="${fileName}">点击这里下载Word文档</a>`;
        goToPage('downloadPage');
    }).catch(err => {
        console.error(err);
        alert('生成文档失败');
    });
}
</script>

</body>
</html>
